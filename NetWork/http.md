### http1.x

#### 持久连接

不需要每次都“三握四挥”的建立连接，可以通过Connection：keep-alive属性保持连接

![img](https://images2015.cnblogs.com/blog/211606/201608/211606-20160807212744637-1476883600.jpg)

#### HTTP管道

每次的请求必须是FIFO的顺序，只有先发送的请求得到响应并传输完成之后，服务器才会处理下一个请求，就是说即使css的优先级高于html文件，但是由于html文件先发送请求，所以必须先相应html文件请求，等html传输完毕再去相应css

![img](https://images2015.cnblogs.com/blog/211606/201608/211606-20160807213633481-1933298397.jpg)

http2.0可以支持多路复用，并按照优先级返回相应

####协议开销

HTTP1.x的增加了请求和相应的首部，造成传输开销增大，而HTTP2.0可以首部压缩，从而减少上面的开销提升性能。

#### 连接与拼合

在HTTP1.x中，我们会采用js合并，css合并，雪碧图等手段减少网络请求来提升性能，在HTTP2.0中支持多向请求和响应，所以可以不同上述操作，减少前端开发的性能优化工作。

#### 嵌入资源

把资源嵌入文档以减少请求次数，比如把js和css代码放在html里面，把图片、音频通过URI嵌入页面中减少请求次数。

### http2.0

http2.0是对http1.x的扩展而非替代。之所以生一个大版本主要是因为它改变了客户端与服务器之间交换数据的方式，http2.0增加了新的`二进制分帧数据层`

#### 二进制分帧数据层

1	位置：封装http消息在客户端和服务器之间传输

2	编码：传输的消息被分割成更小的消息和帧（相对于1.x），并采用二进制格式编码

![img](https://images2015.cnblogs.com/blog/211606/201608/211606-20160807220415840-285627538.jpg)

#### 流、消息、帧

- 流：流是连接中的一个虚拟信道，可以承载双向的消息；每个流都有一个唯一的整数标识符（1、2…N）；我的理解是一个流对应着一个完整的HTTP请求和响应
- 消息：是指逻辑上的 HTTP 消息，比如请求、响应等，由一或多个帧组成。
- 帧：HTTP 2.0 通信的最小单位，每个帧包含帧首部，至少也会标识出当前帧所属的流，承载着特定类型的数据，如 HTTP 首部、负荷，等等

![img](https://raw.githubusercontent.com/zqjflash/http2-protocol/master/http2-connect-stream.png)

#### 多向请求与响应

在HTTP1.x中要并行请求需要建立多个TCP连接，在HTTP2.0中的二进制分帧层突破了这个限制，客户端和服务器可以将HTTP消息分解为互不依赖的帧然后乱序发送，最后在另一端组合起来。![img](https://images2015.cnblogs.com/blog/211606/201608/211606-20160807221148700-946127515.jpg)

#### 请求优先级

每个stream（流）都带有一个31比特的优先值

#### 一个来源一个连接

服务器和客户端只需要建立一个TCP连接即可

#### 服务器可以主动推送

#### 首部压缩

每次首部发送只会发送有差异的属性。减少请求的体积。



### 参考资料

https://blog.csdn.net/zqjflash/article/details/50179235
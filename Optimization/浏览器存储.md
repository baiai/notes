在现代浏览器中存在大量的存储手段，那么如何在众多的存储方案中选出一个合适的方案呢？这就需要我们对每个存储方案的优劣势和原理有清晰的理解。

前端的现代存储主要有：Cookie、LocalStorage、SessionStorage、IndexDB、ServiceWorker，接下来我们一一进行了解。

# Cookie

由于HTTP请求是一种无状态连接，所以使用Cookie来保持客户端的状态，后台发送一个set-cookie的响应头，浏览器就会根据set-cookie的值生成一条cookie信息，以后每次请求时都会带上cookie信息，以此告诉服务器客户端的状态。Cookie本身拥有5KB左右的存储空间，所以经常用于存储用户的账号、密码，使得用户访问页面可以直接处于登录状态。

Cookie的生成有两种方式：第一种，有后台发送带有set-cookie的响应头，前端检测到set-cookie时，就会将set-cookie的值设为一条cookie信息。第二种就是前端通过document.cookie对cookie信息进行写入。

安全方面，cookie有一个HttpOnly的属性，表示cookie无法通过document.cookie读写。 

性能方面，由于cookie是在每次请求中都会携带的，但是很多静态文件是不需要cookie信息的，每一个cookie有4KB的大小，对于一个电商网站来说每天可能是上亿请求，那么这个损耗就很大了。解决办法是将存放静态文件的CDN的域名和主站域名分开，这样访问静态文件的时候，由于不是该域名下的请求，所以不会携带cookie，从而能减少携带cookie的请求过多带来的损耗。



# LocalStorage与SessionStorage

localStorage是本地存储，有5M左右的存储空间，尽在客户端使用而不用和服务端进行通信，LocalStorage可以用于将一些常用的而且不会经常变动的请求保存到LocalStorage中，以此减少服务器的压力并且能够更快的获取数据。

SessionStorage是会话级别的存储，存储大小也是5M左右，如果页面关闭的话，他说存储的信息就会被浏览器清空。所以SessionStorage可以用来对表单信息进行维护，比如在注册页面，我们需要注册许多个人信息，如果不小心刷新了网页或者需要后退修改信息，为了避免用户再一次重复操作，这个时候就可以用SessionStorage来保存用户之前填写的信息。在用户关闭网页标签之后，这些信息会被清空。



# IndexDB

IndexDB是为了解决Web Storage的存储限制而产生的，用户客户端存储大量结构化数据的。IndexDB使用索引实现对数据的高性能搜索。IndexDB存储的值都是一些对象，这些对象可以通过一个key path作为索引值去快速获取。因为，相对于Web Storage存储的是key-value形式的值，IndexDB存储的对象更适合结构化的数据。

IndexDB是通过一个事务对象去操作的，在创建事务与IndexDB的关系时，可以配置事务对IndexDB的访问权限，是可读写还是只读不写等等。



# Service Worker

由于浏览器是单线程，导致UI渲染和JS程序运行会相互阻塞。而Service Worker的作用就是在后台启动其他线程，用于计算JS程序，而后将结果返回给主线程，这样既不会阻塞UI渲染也可以很快的计算出JS代码的结果。所以，Service Worker大大提升了浏览器的JS代码的计算能力。

Serveice Worker可以拦截和处理网络请求，通过编程方式来管理被缓存的响应，在发送请求时，如果命中Service Worker的缓存，可以先从Service Worker中获取缓存的数据，也可以用于离线应用。其次，Service Worker可以和主线程通信，可以将比较复杂的运算交给Service Worker，Service Worker计算完毕之后，将结果返回给主线程，减少因为JS计算带来的UI阻塞。